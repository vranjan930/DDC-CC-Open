<script>
function classifyByIntent(query) {
  const q = query.toLowerCase();

  // ---------- DDC (INTENT-BASED) ----------
  let ddc = "000";
  let ddcNote = "General works";

  if (q.includes("library science") || q.includes("librarianship")) {
    ddc = "020.1";
    ddcNote = "Library science â€“ theory and principles";
  }
  else if (q.includes("classification")) {
    ddc = "025.42";
    ddcNote = "Library classification and indexing";
  }
  else if (q.includes("information retrieval")) {
    ddc = "025.04";
    ddcNote = "Information storage and retrieval systems";
  }
  else if (q.includes("cataloguing") || q.includes("cataloging")) {
    ddc = "025.3";
    ddcNote = "Cataloguing";
  }
  else if (q.includes("political philosophy")) {
    ddc = "320.01";
    ddcNote = "Political philosophy";
  }
  else if (q.includes("relativity")) {
    ddc = "530.12";
    ddcNote = "Relativity (Physics)";
  }

  // ---------- COLON CLASSIFICATION (PMEST) ----------
  let cc = "Z";
  let ccNote = "General knowledge";

  if (q.includes("library science")) {
    cc = "2;44";
    ccNote = "P: Library Science | E: Theory & Principles";
  }
  else if (q.includes("classification")) {
    cc = "2;42";
    ccNote = "P: Library Science | E: Classification";
  }
  else if (q.includes("information retrieval")) {
    cc = "2;7";
    ccNote = "P: Library Science | E: Retrieval";
  }
  else if (q.includes("political philosophy")) {
    cc = "A;6";
    ccNote = "P: Philosophy | E: Political theory";
  }
  else if (q.includes("relativity")) {
    cc = "B;12";
    ccNote = "P: Physics | E: Relativity theory";
  }

  return { ddc, ddcNote, cc, ccNote };
}

async function searchBook() {
  const q = document.getElementById("query").value.trim();
  const status = document.getElementById("status");
  const result = document.getElementById("result");

  if (!q) {
    status.innerText = "Please enter a subject, title, or ISBN.";
    return;
  }

  status.innerText = "Classifying subject intent...";
  const cls = classifyByIntent(q);

  result.innerHTML = `
    <h3>Subject analysed:</h3>
    <p><strong>${q}</strong></p>

    <hr>
    <h4>ðŸ“˜ Dewey Decimal Classification (Suggested)</h4>
    <p><strong>${cls.ddc}</strong> â€” ${cls.ddcNote}</p>

    <h4>ðŸ“— Colon Classification (Suggested)</h4>
    <p><strong>${cls.cc}</strong> â€” ${cls.ccNote}</p>

    <p><em>Classification generated from subject-intent analysis, independent of noisy bibliographic search results.</em></p>
  `;

  status.innerText = "Classification completed.";
}
</script>
